app:
  name: "RNA-PLUM"
  version: "2.0"
  timezone: "Europe/Warsaw"

paths:
  # POPRAWKA A: dodany db_path — parse_events tego wymaga (cfg["paths"]["db_path"])
  # POPRAWKA A: ujednolicona ścieżka DuckDB — wcześniej compute_stats szukał "_run/warehouse.duckdb"
  db_path: "_data/mrna_plum.duckdb"
  parquet_root: "_data/parquet"
  logs_root: "logi_plum"
  merged_logs_out: "_staging/merged"
  output_root: "_out"
  reports_excel: "_out/raport_zbiorczy.xlsx"
  individual_reports_dir: "_out/indywidualne"
  pdf_dir: "_out/pdf"
  excel_template: "wzor_raportu.xlsx"

csv:
  input_glob: "**/*.csv"
  keys_sheet: "KEYS"
  col_time: "Czas"
  col_context: "Kontekst zdarzenia"
  col_desc: "Opis"
  col_component: "Składnik"
  col_event_name: "Nazwa zdarzenia"
  chunk_rows: 200000

ingest:
  # Wzorzec dla plików: logs_WFDist22sem-NazwaPrzedmiotu-202425l_20250422-0855.csv
  filename_coursekey_regex: "^logs_(?P<coursekey>.+?)_\\d{8}-\\d{4}\\.csv$"
  recursive: true
  delimiter_detect: true
  encoding_detect: true
  normalize_to_utf8: true
  dedup:
    mode: "full_row_hash"
    hash: "sha1"

# POPRAWKA B: usunięte {root}/ z ścieżek — kod nie interpoluje tego placeholdera
mapping:
  teacher_id_email: "pliki_zrodlowe/dane_do_raportu.csv"
  email_hr: "pliki_zrodlowe/dane_do_raportu.csv"

parse_events:
  keys_xlsx: "KEYS.xlsx"
  keys_sheet: "KEYS"
  fetch_size: 5000
  insert_batch_size: 20000
  export_parquet: true

build_activities_state:
  snapshots_dir: "_data/snapshots"
  snapshots_glob: "*_zawartosc_kursow.csv"

# POPRAWKA A: ujednolicona ścieżka DuckDB (compute_stats używa tego klucza)
duckdb_path: "_data/mrna_plum.duckdb"
run_dir: "_run"

period:
  ay: "2025/26"
  term: "l"

rebuild_full: false

reports:
  excel:
    include_qc_log: true
  pdf:
    enabled: true
    engine: "excel_com"
    template_fill_mode: "anchors"
